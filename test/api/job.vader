Execute ( SpaceVim api: job ):
  let job = SpaceVim#api#import('job')
  let argv = ['echo', 'foo']
  let g:stdout = ''
  let stderr = ''
  let exit = 1
  function! s:on_stdout(id, data, event) abort
    if a:event ==# 'stdout'
      for a in a:data
        if !empty(a)
          let g:stdout = a
        endif
      endfor
    elseif a:event ==# 'exit'
      let g:exit = a:data
    else
      let g:stderr = a:data
    endif
  endfunction
  let opt = {
    \ 'on_stdout' : function('s:on_stdout'),
    \ 'on_stderr' : function('s:on_stdout'),
    \ 'on_exit' : function('s:on_stdout'),
    \ }
  call job.start(argv,opt)
  sleep 100m
  AssertEqual g:stdout, 'foo'
  AssertEqual exit, 0


